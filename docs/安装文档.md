### 环境安装

1. 安装python3.8
2. 用pip安装依赖(在这一步会把torch依赖一并安装, 但是版本不正确)
```shell
# 配置国内源
pip3.8 config set global.index-url https://mirrors.aliyun.com/pypi/simple/
# 安装python依赖库
pip3.8 install basicsr==1.4.0 opencv-python lpips IPython numpy pyyaml einops
```
3. 重新安装torch和torch-npu(使用目录下的文件)
```shell
cd ~/videoxiufu # cd到部署文件夹的目录下
pip install torch-2.4.0-cp38-cp38-manylinux2014_aarch64.whl
pip install torch_npu-2.4.0.post3-cp38-cp38-manylinux_2_17_aarch64.manylinux2014_aarch64.whl
```
4. 修改依赖库代码
```shell
python3.8 patch.py
```
5. 把待修复视频放置到input目录下, 执行命令, 待修复程序执行结束在output目录下获取到修复后的视频
```shell
python3.8 process_video.py -c options/video.yml
```


### 构建docker镜像并部署

1. 构建镜像
```shell
cd ~/videoxiufu # cd到部署文件夹的目录下
docker build . -t ascendai/pytorch:1.0.0
```
2. 挂在目录并运行容器
```shell
cd ../ # cd到上一级目录
docker run \
    --name torch_container \
    --device /dev/davinci0 \
    --device /dev/davinci1 \
    --device /dev/davinci2 \
    --device /dev/davinci_manager \
    --device /dev/devmm_svm \
    --device /dev/hisi_hdc \
    -v /usr/local/dcmi:/usr/local/dcmi \
    -v /usr/local/bin/npu-smi:/usr/local/bin/npu-smi \
    -v /usr/local/Ascend/driver/lib64/:/usr/local/Ascend/driver/lib64/ \
    -v /usr/local/Ascend/driver/version.info:/usr/local/Ascend/driver/version.info \
    -v /etc/ascend_install.info:/etc/ascend_install.info \
    -v $PWd/videoxiufu:/app \
    -w /app \
    -it -d ascendai/pytorch:1.0.0 bash
```
3. 把待修复视频放置到input目录下, 执行命令, 待修复程序执行结束在output目录下获取到修复后的视频
```shell
docker exec torch_container python process_video.py -c options/video.yml
```







# 离线安装Python 3.8（ARM架构，源码编译版）

## 一、环境说明

- 系统：ARM架构（如昇腾910、鲲鹏920）
- 操作系统：CentOS、openEuler、EulerOS、Ubuntu 等
- 网络状态：完全离线

## 二、总体流程

1. 下载Python源码包
2. 下载编译所需依赖rpm包
3. 上传至目标服务器
4. 安装编译依赖
5. 编译并安装Python
6. 配置环境变量
7. 验证安装

---

## 三、详细步骤

### 1️⃣ 下载Python源码包

在有网的电脑上下载：

```bash
wget https://www.python.org/ftp/python/3.8.18/Python-3.8.18.tgz
```
